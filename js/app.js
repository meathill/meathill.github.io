/*! im-meathill v0.1.0(2016-11-28) */
"use strict";this.TEMPLATE=this.TEMPLATE||{},this.TEMPLATE["blog-template"]=Handlebars.template({1:function(a,b,c,d,e){var f;return null!=(f=c["if"].call(null!=b?b:{},null!=b?b.thumbnail:b,{name:"if",hash:{},fn:a.program(2,e,0),inverse:a.program(4,e,0),data:e}))?f:""},2:function(a,b,c,d,e){var f=a.lambda,g=a.escapeExpression;return'<li class="item has-thumbnail col-md-4 col-sm-6 col-xs-12" style="background-image: url('+g(f(null!=b?b.thumbnail:b,b))+')"><h3><a href="'+g(f(null!=b?b.link:b,b))+'">'+g(f(null!=b?b.title:b,b))+"</a></h3></li>"},4:function(a,b,c,d,e){var f=a.lambda,g=a.escapeExpression;return'<li class="item no-thumbnail col-md-4 col-sm-6 col-xs-12"><h3><a href="'+g(f(null!=b?b.link:b,b))+'">'+g(f(null!=b?b.title:b,b))+"</a></h3><article>"+g(f(null!=b?b.description:b,b))+"</article></li>"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f;return null!=(f=c.each.call(null!=b?b:{},null!=b?b.list:b,{name:"each",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:""},useData:!0});var meathill={},BLOG_URL="http://blog.meathill.com/feed";!function(a){var b="meathill-blogs",c="meathill-latest",d=a.Blog=function(a){this.$el=$(a.el),this.template=TEMPLATE["blog-template"];var d=localStorage.getItem(b);this.latest=Number(localStorage.getItem(c)),d&&(d=JSON.parse(d),this.render(d)),this.latest||(this.latest=isNaN(Number(this.$el.data("latest")))?this.latest:Number(this.$el.data("latest"))),this.fetch()};d.prototype={news:0,fetch:function(){$.ajax(BLOG_URL,{dataType:"xml",context:this,success:this.onSuccess,error:this.onError})},parse:function(a){a=$(a);var b=this,d=[],e=0,f=/^\w+:(\w+)$/,g=/\?p=(\d+)$/;return a.find("item").each(function(a){for(var h={},i=this.firstElementChild;i;){var j=i.namespaceURI&&i.tagName.match(f)>1?i.tagName.match(f)[1]:i.tagName;h[j]=i.textContent.replace(/<a.*>.*?<\/a>/,""),i=i.nextElementSibling}var k=parseInt(h.guid.match(g)[1]);if(0===a){if(k===b.latest)return!1;localStorage.setItem(c,k)}if(k>b.latest&&b.news++,d.push(h),e++,e>5)return!1}),this.news>0&&(this.news=this.news>=5?"5+":this.news,$("#top-bar .blog").append("<span>"+this.news+"</span>")),d},render:function(a){this.$el.html(this.template({list:a}))},onError:function(a,b,c){},onSuccess:function(a,c,d){var e=this.parse(a),f=JSON.stringify(e);0!==e.length&&(localStorage.setItem(b,f),this.render(e))}}}(meathill),$(function(a){var b=$("#top-bar");$(window).on("scroll",function(){var a=document.body.scrollTop;b.toggleClass("active",a>0);for(var d=c.length-1;d>-1;d--)if(c[d]-a<73&&c[d]-a>-33){b.find("li").eq(d).addClass("active").siblings().removeClass("active");break}});var c=[];$("a[name]").each(function(){c.push($(this).offset().top)});new a.Blog({el:"#blog-grid"});!function(a,b,c,d,e,f,g){a.GoogleAnalyticsObject=e,a[e]=a[e]||function(){(a[e].q=a[e].q||[]).push(arguments)},a[e].l=1*new Date,f=b.createElement(c),g=b.getElementsByTagName(c)[0],f.async=1,f.src=d,g.parentNode.insertBefore(f,g)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-26694288-7","auto"),ga("send","pageview")}(meathill));